<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Load Master™: com.pekinsoft.loadmaster.utils.PasswordUtils Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../Northwind48.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Load Master™
   &#160;<span id="projectnumber">0.6.8 build 2583</span>
   </div>
   <div id="projectbrief">An integrated load tracking and accounting system for owner/operator truck drivers.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../d8/dee/namespacecom.html">com</a></li><li class="navelem"><a class="el" href="../../db/d3f/namespacecom_1_1pekinsoft.html">pekinsoft</a></li><li class="navelem"><a class="el" href="../../d9/d37/namespacecom_1_1pekinsoft_1_1loadmaster.html">loadmaster</a></li><li class="navelem"><a class="el" href="../../d3/df5/namespacecom_1_1pekinsoft_1_1loadmaster_1_1utils.html">utils</a></li><li class="navelem"><a class="el" href="../../dc/db1/classcom_1_1pekinsoft_1_1loadmaster_1_1utils_1_1PasswordUtils.html">PasswordUtils</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="../../db/d8e/classcom_1_1pekinsoft_1_1loadmaster_1_1utils_1_1PasswordUtils-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">com.pekinsoft.loadmaster.utils.PasswordUtils Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a41076ceeb9b9a4ec609126e55e855a71"><td class="memItemLeft" align="right" valign="top">static Optional&lt; String &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/db1/classcom_1_1pekinsoft_1_1loadmaster_1_1utils_1_1PasswordUtils.html#a41076ceeb9b9a4ec609126e55e855a71">generateSalt</a> (final int length)</td></tr>
<tr class="memdesc:a41076ceeb9b9a4ec609126e55e855a71"><td class="mdescLeft">&#160;</td><td class="mdescRight">Method provides a means of generating salt for password hashing to protect the password for hackers and allow for storage in a database.  <a href="../../dc/db1/classcom_1_1pekinsoft_1_1loadmaster_1_1utils_1_1PasswordUtils.html#a41076ceeb9b9a4ec609126e55e855a71">More...</a><br /></td></tr>
<tr class="separator:a41076ceeb9b9a4ec609126e55e855a71"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64a94ac879c6b82e02ad529b09bd7676"><td class="memItemLeft" align="right" valign="top">static Optional&lt; String &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/db1/classcom_1_1pekinsoft_1_1loadmaster_1_1utils_1_1PasswordUtils.html#a64a94ac879c6b82e02ad529b09bd7676">hashPassword</a> (String password, String salt)</td></tr>
<tr class="memdesc:a64a94ac879c6b82e02ad529b09bd7676"><td class="mdescLeft">&#160;</td><td class="mdescRight">This method actually performs the hashing of the provided password, using the provided salt string.  <a href="../../dc/db1/classcom_1_1pekinsoft_1_1loadmaster_1_1utils_1_1PasswordUtils.html#a64a94ac879c6b82e02ad529b09bd7676">More...</a><br /></td></tr>
<tr class="separator:a64a94ac879c6b82e02ad529b09bd7676"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ed6eb749963df76d21f2a9d8626cdd5"><td class="memItemLeft" align="right" valign="top">static boolean&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/db1/classcom_1_1pekinsoft_1_1loadmaster_1_1utils_1_1PasswordUtils.html#a0ed6eb749963df76d21f2a9d8626cdd5">verifyPassword</a> (String password, String key, String salt)</td></tr>
<tr class="memdesc:a0ed6eb749963df76d21f2a9d8626cdd5"><td class="mdescLeft">&#160;</td><td class="mdescRight">This method allows the calling application to verify that a user entered the correct password, by checking it against a known hash.  <a href="../../dc/db1/classcom_1_1pekinsoft_1_1loadmaster_1_1utils_1_1PasswordUtils.html#a0ed6eb749963df76d21f2a9d8626cdd5">More...</a><br /></td></tr>
<tr class="separator:a0ed6eb749963df76d21f2a9d8626cdd5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><dl class="section author"><dt>Author</dt><dd>Sean Carrick &lt;sean at pekinsoft dot com&gt;</dd></dl>
<dl class="section version"><dt>Version</dt><dd>0.1.0 </dd></dl>
<dl class="section since"><dt>Since</dt><dd>0.1.0 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d8/d4f/PasswordUtils_8java_source.html#l00053">53</a> of file <a class="el" href="../../d8/d4f/PasswordUtils_8java_source.html">PasswordUtils.java</a>.</p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="a41076ceeb9b9a4ec609126e55e855a71"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a41076ceeb9b9a4ec609126e55e855a71">&#9670;&nbsp;</a></span>generateSalt()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static Optional&lt;String&gt; com.pekinsoft.loadmaster.utils.PasswordUtils.generateSalt </td>
          <td>(</td>
          <td class="paramtype">final int&#160;</td>
          <td class="paramname"><em>length</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Method provides a means of generating salt for password hashing to protect the password for hackers and allow for storage in a database. </p>
<p>Password-based encryption generates a cryptographic key using a user password as a starting point. We irreversibly convert the password to a fixed-length hash code using a one-way hash function, adding a second random string as &quot;salt&quot;, to prevent hackers from performing <em>dictionary attacks</em>, where a list of common passwords are mapped to their hashed outputs &ndash; if the hacker knows the hashing algorithm used and can gain access to the database where the hashcodes are stored, they can use their &quot;dictionary&quot; to map back to the original password and gain access to those accounts.</p>
<p>We provide this method to allow the calling application to generate salt.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">length</td><td>Number of bits of salt to generate. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Optional&lt;String&gt; of the salt. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d8/d4f/PasswordUtils_8java_source.html#l00088">88</a> of file <a class="el" href="../../d8/d4f/PasswordUtils_8java_source.html">PasswordUtils.java</a>.</p>
<div class="fragment"><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;                                                                  {</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        <span class="keywordflow">if</span> ( length &lt; 1 ) {</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;            System.err.println(<span class="stringliteral">&quot;error in generateSalt :: length must be &gt; 0&quot;</span>);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;            <span class="keywordflow">return</span> Optional.empty();</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        }</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        </div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        <span class="keywordtype">byte</span>[] salt = <span class="keyword">new</span> <span class="keywordtype">byte</span>[length];</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        RAND.nextBytes(salt);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        </div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        <span class="keywordflow">return</span> Optional.of(Base64.getEncoder().encodeToString(salt));</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a64a94ac879c6b82e02ad529b09bd7676"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a64a94ac879c6b82e02ad529b09bd7676">&#9670;&nbsp;</a></span>hashPassword()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static Optional&lt;String&gt; com.pekinsoft.loadmaster.utils.PasswordUtils.hashPassword </td>
          <td>(</td>
          <td class="paramtype">String&#160;</td>
          <td class="paramname"><em>password</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">String&#160;</td>
          <td class="paramname"><em>salt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This method actually performs the hashing of the provided password, using the provided salt string. </p>
<p>With these two ingredients, we will generate a secure hash that can be stored in a database or password file and not be able to be determined what the original password was. </p>
<p>For security's sake, we immediately convert the password to a character array and the salt to a byte array. As soon as we are done with the provided strings, we set them up for garbage collection. Likewise, as soon as we are done with the arrays, we place null characters in each element, so as to keep the original password a secret.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">password</td><td>String pulled from a password field on a logon dialog. </td></tr>
    <tr><td class="paramname">salt</td><td>String of randomly generated salt. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A secure hash of the original password. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d8/d4f/PasswordUtils_8java_source.html#l00116">116</a> of file <a class="el" href="../../d8/d4f/PasswordUtils_8java_source.html">PasswordUtils.java</a>.</p>
<div class="fragment"><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                                                                              {</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        <span class="keywordtype">char</span>[] chars = password.toCharArray();</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        <span class="keywordtype">byte</span>[] bytes = salt.getBytes();</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        </div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        PBEKeySpec spec = <span class="keyword">new</span> PBEKeySpec(chars, bytes, ITERATIONS, KEY_LENGTH);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        </div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        Arrays.fill(chars, Character.MIN_VALUE);</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        </div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;            SecretKeyFactory fac = SecretKeyFactory.getInstance(ALGORITHM);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;            <span class="keywordtype">byte</span>[] securePassword = fac.generateSecret(spec).getEncoded();</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;            <span class="keywordflow">return</span> Optional.of(Base64.getEncoder().encodeToString(securePassword));</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;            </div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        } <span class="keywordflow">catch</span> (NoSuchAlgorithmException | InvalidKeySpecException ex) {</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;            System.err.println(<span class="stringliteral">&quot;Exception encountered in hashPassword()&quot;</span>);</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;            <span class="keywordflow">return</span> Optional.empty();</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        } <span class="keywordflow">finally</span> {</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;            spec.clearPassword();</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        }</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a0ed6eb749963df76d21f2a9d8626cdd5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ed6eb749963df76d21f2a9d8626cdd5">&#9670;&nbsp;</a></span>verifyPassword()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static boolean com.pekinsoft.loadmaster.utils.PasswordUtils.verifyPassword </td>
          <td>(</td>
          <td class="paramtype">String&#160;</td>
          <td class="paramname"><em>password</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">String&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">String&#160;</td>
          <td class="paramname"><em>salt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This method allows the calling application to verify that a user entered the correct password, by checking it against a known hash. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">password</td><td>The entered password. </td></tr>
    <tr><td class="paramname">key</td><td>The hash of the original password that was stored. </td></tr>
    <tr><td class="paramname">salt</td><td>The same random salt as originally used. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Whether the passwords match or not. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d8/d4f/PasswordUtils_8java_source.html#l00146">146</a> of file <a class="el" href="../../d8/d4f/PasswordUtils_8java_source.html">PasswordUtils.java</a>.</p>
<div class="fragment"><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;                                                                                   {</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        Optional&lt;String&gt; optEncrypted = <a class="code" href="../../dc/db1/classcom_1_1pekinsoft_1_1loadmaster_1_1utils_1_1PasswordUtils.html#a64a94ac879c6b82e02ad529b09bd7676">hashPassword</a>(password, salt);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        <span class="keywordflow">if</span> (!optEncrypted.isPresent()) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        <span class="keywordflow">return</span> optEncrypted.get().equals(key);</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    }</div>
</div><!-- fragment -->
</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>LoadMaster/Load Master/src/com/pekinsoft/loadmaster/utils/<a class="el" href="../../d8/d4f/PasswordUtils_8java_source.html">PasswordUtils.java</a></li>
</ul>
</div><!-- contents -->
<div class="ttc" id="aclasscom_1_1pekinsoft_1_1loadmaster_1_1utils_1_1PasswordUtils_html_a64a94ac879c6b82e02ad529b09bd7676"><div class="ttname"><a href="../../dc/db1/classcom_1_1pekinsoft_1_1loadmaster_1_1utils_1_1PasswordUtils.html#a64a94ac879c6b82e02ad529b09bd7676">com.pekinsoft.loadmaster.utils.PasswordUtils.hashPassword</a></div><div class="ttdeci">static Optional&lt; String &gt; hashPassword(String password, String salt)</div><div class="ttdoc">This method actually performs the hashing of the provided password, using the provided salt string.</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4f/PasswordUtils_8java_source.html#l00116">PasswordUtils.java:116</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
